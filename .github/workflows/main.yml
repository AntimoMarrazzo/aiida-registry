name: CI

on: [push]
#on:
#  schedule:
#  # run every at 21:00 UTC
#  - cron: "0 21 * * *"

jobs:
  daily_build:
    runs-on: ubuntu-latest
    env:
      COMMIT_AUTHOR: Daily Deploy GitHub Workflow
      COMMIT_AUTHOR_EMAIL: deploy@github-actions.org
    steps:
    - uses: actions/checkout@v1
    - name: Set up Python 3.7
      uses: actions/setup-python@v1
      with:
        python-version: 3.7
    - name: Install prerequisites
      run: pip install --upgrade wheel setuptools
    - name: Install
      run: pip install -e . -v
    - name: fetch metadata
      run: aiida-registry fetch
    - name: make pages
      run: aiida-registry html
    - name: deploy
      run: ./.github/deploy.sh
